Bootstrap: docker
From: pytorch/pytorch:2.3.1-cuda11.8-cudnn8-runtime

%post
    apt-get update && apt-get install -y --no-install-recommends \
        ca-certificates \
        && rm -rf /var/lib/apt/lists/* && apt-get clean

    # Here Python & torch are already installed
    pip install --no-cache-dir numpy

%environment
    export PIP_NO_CACHE_DIR=1
    export PIP_DISABLE_PIP_VERSION_CHECK=1

%runscript
    exec python train.py
